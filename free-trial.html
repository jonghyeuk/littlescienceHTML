<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>LittleScienceAI ë¬´ë£Œì²´í—˜ - 20ë¶„ ë¬´ë£Œë¡œ ì²´í—˜í•´ë³´ì„¸ìš”!</title>
  <!-- (ìƒëµ) CSS ì „ì²´ëŠ” ê·¸ëŒ€ë¡œ ë‘ì—ˆìŠµë‹ˆë‹¤ -->
  <style>
    /* ... ê¸°ì¡´ CSS ì „ì²´ ìœ ì§€ ... */
  </style>
</head>
<body>
  <div class="container">
    <div class="free-badge">âœ¨ 100% ë¬´ë£Œ</div>
    <div class="header">
      <h1>ğŸ§ª LittleScienceAI</h1>
      <div class="subtitle">20ë¶„ ë¬´ë£Œ ì²´í—˜</div>
      <p>ê³¼í•™ë…¼ë¬¸ ì£¼ì œ íƒìƒ‰ì˜ ìƒˆë¡œìš´ ê²½í—˜ì„ ë¬´ë£Œë¡œ ë§Œë‚˜ë³´ì„¸ìš”.<br>ê²°ì œ ì—†ì´ ì´ë©”ì¼ í•˜ë‚˜ë¡œ ë°”ë¡œ ì‹œì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤!</p>
    </div>

    <div class="benefits">
      <h3>â° 20ë¶„ ë™ì•ˆ ì²´í—˜í•  ìˆ˜ ìˆëŠ” ê²ƒë“¤</h3>
      <div class="benefit-grid">
        <div class="benefit-item"><div class="benefit-icon">ğŸ¯</div><div class="benefit-title">AI ì£¼ì œ ì¶”ì²œ</div><div class="benefit-desc">ê´€ì‹¬ ë¶„ì•¼ ì…ë ¥ ì‹œ ë§ì¶¤í˜• ì—°êµ¬ ì£¼ì œ ì œì•ˆ</div></div>
        <div class="benefit-item"><div class="benefit-icon">ğŸ“š</div><div class="benefit-title">ì„ í–‰ì—°êµ¬ ë¶„ì„</div><div class="benefit-desc">ìœ ì‚¬ ì—°êµ¬ ì‚¬ë¡€ì™€ ì°¸ê³ ë¬¸í—Œ ìë™ íƒìƒ‰</div></div>
        <div class="benefit-item"><div class="benefit-icon">ğŸ“„</div><div class="benefit-title">ë…¼ë¬¸ êµ¬ì¡° ì œì•ˆ</div><div class="benefit-desc">ì„œë¡ , ë°©ë²•ë¡ , ê²°ë¡ ê¹Œì§€ ì²´ê³„ì  ê°€ì´ë“œ</div></div>
        <div class="benefit-item"><div class="benefit-icon">ğŸ’¡</div><div class="benefit-title">í‹ˆìƒˆ ì£¼ì œ ë°œêµ´</div><div class="benefit-desc">ì°½ì˜ì ì´ê³  ë…ì°½ì ì¸ ì—°êµ¬ ë°©í–¥ ì œì‹œ</div></div>
      </div>
    </div>

    <form class="form-section" onsubmit="handleFormSubmit(event)">
      <div class="input-group">
        <input type="email" id="userEmail" placeholder="ğŸ“§ ì´ë©”ì¼ ì£¼ì†Œë¥¼ ì…ë ¥í•˜ì„¸ìš”" required>
        <button type="submit" class="send-btn" id="sendBtn">â¤</button>
      </div>
      <div class="notice">âš¡ ì²´í—˜ìš© ì•¡ì„¸ìŠ¤ ì½”ë“œê°€ ì¦‰ì‹œ ë°œì†¡ë©ë‹ˆë‹¤</div>
    </form>

    <div class="result" id="resultMessage"></div>

    <div class="bottom-links">
      <p>ë” ì˜¤ë˜ ì‚¬ìš©í•˜ê³  ì‹¶ë‹¤ë©´?</p>
      <a href="purchase.html" class="link-btn">ğŸ’³ ìœ ë£Œ ì´ìš©ê¶Œ êµ¬ë§¤</a>
      <a href="index.html" class="link-btn">ğŸ  ë©”ì¸ í˜ì´ì§€ë¡œ</a>
    </div>
  </div>

  <script>
    const TEST_MODE = false;

    function handleFormSubmit(event) {
      event.preventDefault();
      const email = document.getElementById('userEmail').value;
      const btn = document.getElementById('sendBtn');

      if (!email || !isValidEmail(email)) {
        showError('ì˜¬ë°”ë¥¸ ì´ë©”ì¼ ì£¼ì†Œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
        return;
      }

      if (TEST_MODE) {
        testMode(email);
      } else {
        btn.disabled = true;
        btn.className = 'send-btn loading';
        btn.innerHTML = 'â³';
        processFreeTrial(email).then(res => {
          btn.className = 'send-btn success';
          btn.innerHTML = 'âœ…';
          showSuccess(`<h4>ğŸ‰ ì™„ë£Œ!</h4><p><strong>${res.email}</strong> ë¡œ ìš”ì²­ì´ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤.</p>`);
          setTimeout(() => resetButton(), 3000);
        }).catch(err => {
          btn.disabled = false;
          showError('ì „ì†¡ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì½˜ì†”ì„ í™•ì¸í•´ì£¼ì„¸ìš”.');
          resetButton();
        });
      }
    }

    function processFreeTrial(email) {
      return new Promise(async (resolve, reject) => {
        try {
          const userIP = await getUserIP();
          const deviceFingerprint = generateDeviceFingerprint();
          const scriptUrl = 'https://script.google.com/macros/s/AKfycbzJn7ku_zQvtb-GP0Z_-QA1O1VWugYjc1_FIldnRbjwj1J6leheeRGqJgIt9nnokkXR0Q/exec';

          const form = document.createElement('form');
          form.method = 'POST';
          form.action = scriptUrl;
          form.target = '_blank';
          form.style.display = 'none';

          const fields = {
            action: 'free_trial',
            userEmail: email,
            userIP: userIP,
            deviceFingerprint: deviceFingerprint
          };

          Object.keys(fields).forEach(key => {
            const input = document.createElement('input');
            input.type = 'hidden';
            input.name = key;
            input.value = fields[key];
            form.appendChild(input);
          });

          document.body.appendChild(form);
          form.submit();

          setTimeout(() => {
            if (form.parentNode) document.body.removeChild(form);
          }, 1000);

          resolve({ success: true, email });
        } catch (error) {
          reject(error);
        }
      });
    }

    async function getUserIP() {
      try {
        const response = await fetch('https://api.ipify.org?format=json');
        const data = await response.json();
        return data.ip;
      } catch (e) {
        return 'unknown';
      }
    }

    function generateDeviceFingerprint() {
      try {
        const canvas = document.createElement('canvas');
        const ctx = canvas.getContext('2d');
        ctx.textBaseline = 'top';
        ctx.font = '14px Arial';
        ctx.fillText('LittleScienceAI', 2, 2);

        const fingerprint = [
          navigator.userAgent,
          navigator.language,
          screen.width + 'x' + screen.height,
          new Date().getTimezoneOffset(),
          canvas.toDataURL()
        ].join('|');

        return btoa(fingerprint).slice(0, 20);
      } catch (e) {
        return 'unknown';
      }
    }

    function isValidEmail(email) {
      const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      return emailRegex.test(email);
    }

    function showSuccess(message) {
      const resultDiv = document.getElementById('resultMessage');
      resultDiv.className = 'result success';
      resultDiv.innerHTML = message;
      resultDiv.style.display = 'block';
      resultDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
    }

    function showError(message) {
      const resultDiv = document.getElementById('resultMessage');
      resultDiv.className = 'result error';
      resultDiv.innerHTML = `<h4>âŒ ì˜¤ë¥˜</h4><p>${message}</p>`;
      resultDiv.style.display = 'block';
    }

    function resetButton() {
      const btn = document.getElementById('sendBtn');
      btn.disabled = false;
      btn.className = 'send-btn';
      btn.innerHTML = 'â¤';
    }

    function testMode(email) {
      const btn = document.getElementById('sendBtn');
      btn.disabled = true;
      btn.className = 'send-btn loading';
      btn.innerHTML = 'â³';
      setTimeout(() => {
        btn.className = 'send-btn success';
        btn.innerHTML = 'âœ…';
        showSuccess(`<h4>ğŸ§ª í…ŒìŠ¤íŠ¸ ëª¨ë“œ</h4><p><strong>${email}</strong> ë¡œ í…ŒìŠ¤íŠ¸ ì „ì†¡ ì™„ë£Œ.</p>`);
        setTimeout(() => resetButton(), 3000);
      }, 2000);
    }

    document.getElementById('userEmail').addEventListener('input', function (e) {
      const email = e.target.value;
      const btn = document.getElementById('sendBtn');
      if (email && isValidEmail(email)) {
        btn.style.opacity = '1';
        btn.style.transform = 'scale(1)';
      } else if (email) {
        btn.style.opacity = '0.7';
        btn.style.transform = 'scale(0.95)';
      } else {
        btn.style.opacity = '1';
        btn.style.transform = 'scale(1)';
      }
    });
  </script>
</body>
</html>
